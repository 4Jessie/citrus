<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
	
	<description>
        This web application context contains Spring-WS beans. The beans defined describe the sample HelloService. 
        You can use this sample as template for your own service implementation. 
    </description>
    
	<bean id="helloServicePayloadMapping" class="org.springframework.ws.server.endpoint.mapping.PayloadRootQNameEndpointMapping">
        <description>
            This endpoint mapping uses the qualified name of the payload (body contents) to determine the endpoint for
            an incoming message. The mapping will handle all requests related to the HelloService sample. 
            The mapping uses the default web service endpoint and additionally uses a validation interceptor.
        </description>
        <property name="mappings">
            <props>
                <prop key="{http://www.consol.de/schemas/samples/sayHello.xsd}HelloRequest">helloServiceEndpoint</prop>
            </props>
        </property>
        <property name="interceptors">
            <list>
                <ref local="helloServiceValidatingInterceptor"/>
                <ref bean="loggingInterceptor"/>
            </list>
        </property>
    </bean>

    <bean id="helloServiceValidatingInterceptor"
          class="org.springframework.ws.soap.server.endpoint.interceptor.PayloadValidatingInterceptor">
        <description>
            This interceptor validates both incoming and outgoing message contents according to the XML Schema file.
        </description>
        <property name="xsdSchema" ref="helloServiceSchema"/>
        <property name="validateRequest" value="true"/>
        <property name="validateResponse" value="true"/>
    </bean>
    
	<bean id="helloService" class="org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition">
		<description>
            This bean definition represents a WSDL definition that is generated at runtime. It can be retrieved by
            going to /helloService/helloService.wsdl
        </description>
        <property name="schema" ref="helloServiceSchema"/>
        <property name="portTypeName" value="HelloService"/>
        <property name="locationUri" value="http://localhost:8081/HelloService/services"/>
        <property name="targetNamespace" value="http://www.consol.de/schemas/samples/sayHello.xsd"/>
    </bean>

    <bean id="helloServiceSchema" class="org.springframework.xml.xsd.SimpleXsdSchema">
        <property name="xsd" value="classpath:com/consol/citrus/ws/hello/sayHello.xsd"/>
    </bean>
    
    <bean id="helloServiceEndpoint" class="com.consol.citrus.ws.WebServiceEndpoint">
        <property name="messageHandler">
            <bean class="com.consol.citrus.ws.handler.StaticResponseProducingMessageHandler">
                <property name="messagePayload">
                    <value>
                    <![CDATA[
                        <ns0:HelloResponse xmlns:ns0="http://www.consol.de/schemas/samples/sayHello.xsd">
                            <ns0:MessageId>123456789</ns0:MessageId>
                            <ns0:CorrelationId>CORR123456789</ns0:CorrelationId>
                            <ns0:User>TIBCO</ns0:User>
                            <ns0:Text>Hello TestFramework</ns0:Text>
                        </ns0:HelloResponse>
                    ]]>
                    </value>
                </property>
                <property name="messageHeader">
                    <map>
                        <entry key="{http://www.consol.de/schemas/samples/sayHello.xsd}ns0:Operation" value="sayHelloResponse"/>
                        <entry key="{http://www.consol.de/schemas/samples/sayHello.xsd}ns0:Request" value="HelloRequest"/>
                        <entry key="{http://www.consol.de/schemas/samples/sayHello.xsd}ns0:SOAPAction" value="sayHello"/>
                    </map>
                </property>
            </bean>
        </property>
    </bean>
</beans>