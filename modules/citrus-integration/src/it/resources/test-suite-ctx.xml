<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd
       http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.0.xsd">
	 
	<bean name="testSuite" class="com.consol.citrus.TestSuite" abstract="true">
		<property name="threadCount" value="1"/>
		<property name="reporter">
			<list>
				<bean class="com.consol.citrus.report.SimpleLogReporter"/>
			</list>
		</property>
		<property name="tasksBefore">
			<list>
                <bean class="com.consol.citrus.actions.StartupBean">
                    <property name="server" ref="activeMQBroker"/>
                </bean>
                
				<ref bean="purgeJmsQueues"/>
				<ref bean="startJmsLoopBackDummies"/>
				
				<bean id="initDatabase" parent="databaseAccess">
					<property name="statements">
						<list>
							<value>CREATE TABLE ORDERS (ORDER_ID integer, REQUEST_TAG char(250), CONVERSATION_ID  char(250), CREATION_DATE  char(250), DESCRIPTION char(250)) </value>
							<value>CREATE TABLE CUSTOMERS (CUSTOMER_ID integer, NAME char(250), DESCRIPTION char(250))</value>
							<value>CREATE TABLE ERRORS (ERROR_ID integer, DESCRIPTION char(250))</value>
						</list>
					</property>
				</bean>
			</list>
		</property>
		<property name="tasksBetween">
			<list>
				<ref bean="purgeJmsQueues"/>
			</list>
		</property>
		<property name="tasksAfter">
			<list>
				<ref bean="stopJmsLoopBackDummies"/>
				
                <bean class="com.consol.citrus.actions.ShutdownBean">
                    <property name="server" ref="activeMQBroker"/>
                </bean>
                
				<bean id="destroyDatabase" parent="databaseAccess">
                    <property name="ignoreErrors" value="true"/>
					<property name="statements">
						<list>
							<value>DROP TABLE ORDERS</value>
							<value>DROP TABLE CUSTOMERS</value>
							<value>DROP TABLE ERRORS</value>
						</list>
					</property>
				</bean>
			</list>
		</property>
		<property name="excludeTests">
			<list>
				<value>httpServerTest</value>
			</list>
		</property>
	</bean>
	
	<bean name="coreTestSuite" parent="testSuite"/>
	
</beans>